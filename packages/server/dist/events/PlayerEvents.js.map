{
  "version": 3,
  "sources": ["../../../../src/server/events/PlayerEvents.ts"],
  "sourcesContent": ["import { Logger } from \"../utils/Logger\";\nimport { User } from \"../models/User\";\nimport { PlayerUtils } from \"../utils/PlayerUtils\";\nimport { AdminConfig, Theme } from \"../config/AdminLevels\";\nimport { CommandManager } from \"../commands/CommandManager\";\nimport { AuthService } from \"../services/AuthService\";\n\nexport class PlayerEvents {\n    static init() {\n        mp.events.add(\"playerJoin\", async (player: PlayerMp) => {\n            const user = await User.findOneBy({ username: player.name });\n            \n            player.outputChatBox(Theme.Divider);\n            player.outputChatBox(`${Theme.Text}Bun venit pe ${Theme.Primary}ServerServeros${Theme.Text}, ${Theme.Primary}${player.name}${Theme.Text}.`);\n            \n            if (user) {\n                player.outputChatBox(`${Theme.Secondary}Sistem: ${Theme.Text}Contul tau este securizat. Foloseste ${Theme.Success}/login <parola>${Theme.Text}.`);\n            } else {\n                player.outputChatBox(`${Theme.Secondary}Sistem: ${Theme.Text}Numele tau nu este inregistrat. Foloseste ${Theme.Primary}/register <parola>${Theme.Text}.`);\n            }\n            player.outputChatBox(Theme.Divider);\n            \n            Logger.info(`[JOIN] ${player.name} (ID: ${player.id}) s-a conectat.`);\n        });\n\n        mp.events.add(\"playerChat\", (player: PlayerMp, message: string) => {\n            const db = PlayerUtils.getDb(player);\n            if (!db) {\n                player.outputChatBox(`${Theme.Error}Sistem: ${Theme.Text}Trebuie sa te autentifici pentru a utiliza chat-ul.`);\n                return;\n            }\n\n            const config = AdminConfig[db.adminLevel as keyof typeof AdminConfig];\n            \n            // Format Premium: [Titlu] Nume (ID): Mesaj\n            // Folosim Secondary (gri) pentru ID si paranteze pentru a nu incarca vizual\n            const titlePrefix = db.adminLevel > 0 ? `${config.color}${config.title} ` : \"\";\n            const formattedMsg = `${titlePrefix}${Theme.Text}${player.name} ${Theme.Secondary}(${player.id})${Theme.Text}: ${Theme.Text}${message}`;\n\n            // Proximity Chat optimizat (20 metri pentru realism)\n            mp.players.forEachInRange(player.position, 20, (nearPlayer) => {\n                nearPlayer.outputChatBox(formattedMsg);\n            });\n            \n            Logger.info(`[CHAT] ${player.name}: ${message}`);\n        });\n\n        mp.events.add(\"playerCommand\", (player: PlayerMp, message: string) => {\n            CommandManager.handleCommand(player, message);\n        });\n\n        mp.events.add(\"playerQuit\", async (player: PlayerMp, exitType: string) => {\n            const db = PlayerUtils.getDb(player);\n            if (db) {\n                await AuthService.savePlayer(player);\n                Logger.info(`[QUIT] ${player.name} a parasit sesiunea.`);\n            }\n        });\n    }\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAuB;AACvB,kBAAqB;AACrB,yBAA4B;AAC5B,yBAAmC;AACnC,4BAA+B;AAC/B,yBAA4B;AAErB,MAAM,aAAa;AAAA,EACtB,OAAO,OAAO;AACV,OAAG,OAAO,IAAI,cAAc,OAAO,WAAqB;AACpD,YAAM,OAAO,MAAM,iBAAK,UAAU,EAAE,UAAU,OAAO,KAAK,CAAC;AAE3D,aAAO,cAAc,yBAAM,OAAO;AAClC,aAAO,cAAc,GAAG,yBAAM,IAAI,gBAAgB,yBAAM,OAAO,iBAAiB,yBAAM,IAAI,KAAK,yBAAM,OAAO,GAAG,OAAO,IAAI,GAAG,yBAAM,IAAI,GAAG;AAE1I,UAAI,MAAM;AACN,eAAO,cAAc,GAAG,yBAAM,SAAS,WAAW,yBAAM,IAAI,wCAAwC,yBAAM,OAAO,kBAAkB,yBAAM,IAAI,GAAG;AAAA,MACpJ,OAAO;AACH,eAAO,cAAc,GAAG,yBAAM,SAAS,WAAW,yBAAM,IAAI,6CAA6C,yBAAM,OAAO,qBAAqB,yBAAM,IAAI,GAAG;AAAA,MAC5J;AACA,aAAO,cAAc,yBAAM,OAAO;AAElC,2BAAO,KAAK,UAAU,OAAO,IAAI,SAAS,OAAO,EAAE,iBAAiB;AAAA,IACxE,CAAC;AAED,OAAG,OAAO,IAAI,cAAc,CAAC,QAAkB,YAAoB;AAC/D,YAAM,KAAK,+BAAY,MAAM,MAAM;AACnC,UAAI,CAAC,IAAI;AACL,eAAO,cAAc,GAAG,yBAAM,KAAK,WAAW,yBAAM,IAAI,qDAAqD;AAC7G;AAAA,MACJ;AAEA,YAAM,SAAS,+BAAY,GAAG,UAAsC;AAIpE,YAAM,cAAc,GAAG,aAAa,IAAI,GAAG,OAAO,KAAK,GAAG,OAAO,KAAK,MAAM;AAC5E,YAAM,eAAe,GAAG,WAAW,GAAG,yBAAM,IAAI,GAAG,OAAO,IAAI,IAAI,yBAAM,SAAS,IAAI,OAAO,EAAE,IAAI,yBAAM,IAAI,KAAK,yBAAM,IAAI,GAAG,OAAO;AAGrI,SAAG,QAAQ,eAAe,OAAO,UAAU,IAAI,CAAC,eAAe;AAC3D,mBAAW,cAAc,YAAY;AAAA,MACzC,CAAC;AAED,2BAAO,KAAK,UAAU,OAAO,IAAI,KAAK,OAAO,EAAE;AAAA,IACnD,CAAC;AAED,OAAG,OAAO,IAAI,iBAAiB,CAAC,QAAkB,YAAoB;AAClE,2CAAe,cAAc,QAAQ,OAAO;AAAA,IAChD,CAAC;AAED,OAAG,OAAO,IAAI,cAAc,OAAO,QAAkB,aAAqB;AACtE,YAAM,KAAK,+BAAY,MAAM,MAAM;AACnC,UAAI,IAAI;AACJ,cAAM,+BAAY,WAAW,MAAM;AACnC,6BAAO,KAAK,UAAU,OAAO,IAAI,sBAAsB;AAAA,MAC3D;AAAA,IACJ,CAAC;AAAA,EACL;AACJ;",
  "names": []
}
