{
  "version": 3,
  "sources": ["../../../../src/server/commands/CommandManager.ts"],
  "sourcesContent": ["import fs from \"fs\";\nimport path from \"path\";\nimport { Logger } from \"../utils/Logger\";\nimport { findCommand, getAllCommands } from \"./CommandRegistry\";\nimport { PlayerUtils } from \"../utils/PlayerUtils\";\nimport { Theme } from \"../config/AdminLevels\";\n\nexport class CommandManager {\n    static async loadCommands() {\n        const commandsPath = __dirname;\n        const totalFiles = this.readDirRecursive(commandsPath);\n        \n        const commands = getAllCommands();\n        Logger.info(`[CMD] Sistem Enterprise activat. ${commands.length} comenzi din ${totalFiles} module.`);\n    }\n\n    private static readDirRecursive(dir: string): number {\n        let count = 0;\n        const items = fs.readdirSync(dir);\n\n        for (const item of items) {\n            const fullPath = path.join(dir, item);\n            if (fs.statSync(fullPath).isDirectory()) {\n                count += this.readDirRecursive(fullPath);\n            } else if (item.endsWith(\".js\") && !item.includes(\"CommandManager\") && !item.includes(\"CommandRegistry\")) {\n                try {\n                    delete require.cache[require.resolve(fullPath)];\n                    require(fullPath);\n                    count++;\n                } catch (e) {\n                    Logger.error(`Eroare la modulul ${item}:`, (e as any).message);\n                }\n            }\n        }\n        return count;\n    }\n\n    static handleCommand(player: PlayerMp, message: string) {\n        const args = message.split(\" \");\n        const trigger = args.shift()?.toLowerCase();\n        if (!trigger) return;\n\n        const cmd = findCommand(trigger);\n        if (!cmd) {\n            player.outputChatBox(`${Theme.Error}Eroare: ${Theme.Text}Comanda ${Theme.Primary}/${trigger}${Theme.Text} nu exista. Foloseste ${Theme.Primary}/help.`);\n            return;\n        }\n\n        const user = PlayerUtils.getDb(player);\n        if (!user && cmd.name !== \"login\" && cmd.name !== \"register\") {\n            player.outputChatBox(`${Theme.Error}Sistem: ${Theme.Text}Trebuie sa te autentifici pentru a accesa sistemul.`);\n            return;\n        }\n\n        if (cmd.minAdmin && (!user || user.adminLevel < cmd.minAdmin)) {\n            player.outputChatBox(`${Theme.Error}Securitate: ${Theme.Text}Nivel de acces insuficient.`);\n            return;\n        }\n\n        try {\n            cmd.execute(player, args, args.join(\" \"));\n        } catch (e) {\n            Logger.error(`Eroare executie /${cmd.name}:`, (e as any).stack);\n            player.outputChatBox(`${Theme.Error}Eroare: ${Theme.Text}Procesare esuata.`);\n        }\n    }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAe;AACf,kBAAiB;AACjB,oBAAuB;AACvB,6BAA4C;AAC5C,yBAA4B;AAC5B,yBAAsB;AAEf,MAAM,eAAe;AAAA,EACxB,aAAa,eAAe;AACxB,UAAM,eAAe;AACrB,UAAM,aAAa,KAAK,iBAAiB,YAAY;AAErD,UAAM,eAAW,uCAAe;AAChC,yBAAO,KAAK,oCAAoC,SAAS,MAAM,gBAAgB,UAAU,UAAU;AAAA,EACvG;AAAA,EAEA,OAAe,iBAAiB,KAAqB;AACjD,QAAI,QAAQ;AACZ,UAAM,QAAQ,UAAAA,QAAG,YAAY,GAAG;AAEhC,eAAW,QAAQ,OAAO;AACtB,YAAM,WAAW,YAAAC,QAAK,KAAK,KAAK,IAAI;AACpC,UAAI,UAAAD,QAAG,SAAS,QAAQ,EAAE,YAAY,GAAG;AACrC,iBAAS,KAAK,iBAAiB,QAAQ;AAAA,MAC3C,WAAW,KAAK,SAAS,KAAK,KAAK,CAAC,KAAK,SAAS,gBAAgB,KAAK,CAAC,KAAK,SAAS,iBAAiB,GAAG;AACtG,YAAI;AACA,iBAAO,QAAQ,MAAM,QAAQ,QAAQ,QAAQ,CAAC;AAC9C,kBAAQ,QAAQ;AAChB;AAAA,QACJ,SAAS,GAAG;AACR,+BAAO,MAAM,qBAAqB,IAAI,KAAM,EAAU,OAAO;AAAA,QACjE;AAAA,MACJ;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AAAA,EAEA,OAAO,cAAc,QAAkB,SAAiB;AArC5D;AAsCQ,UAAM,OAAO,QAAQ,MAAM,GAAG;AAC9B,UAAM,WAAU,UAAK,MAAM,MAAX,mBAAc;AAC9B,QAAI,CAAC,QAAS;AAEd,UAAM,UAAM,oCAAY,OAAO;AAC/B,QAAI,CAAC,KAAK;AACN,aAAO,cAAc,GAAG,yBAAM,KAAK,WAAW,yBAAM,IAAI,WAAW,yBAAM,OAAO,IAAI,OAAO,GAAG,yBAAM,IAAI,yBAAyB,yBAAM,OAAO,QAAQ;AACtJ;AAAA,IACJ;AAEA,UAAM,OAAO,+BAAY,MAAM,MAAM;AACrC,QAAI,CAAC,QAAQ,IAAI,SAAS,WAAW,IAAI,SAAS,YAAY;AAC1D,aAAO,cAAc,GAAG,yBAAM,KAAK,WAAW,yBAAM,IAAI,qDAAqD;AAC7G;AAAA,IACJ;AAEA,QAAI,IAAI,aAAa,CAAC,QAAQ,KAAK,aAAa,IAAI,WAAW;AAC3D,aAAO,cAAc,GAAG,yBAAM,KAAK,eAAe,yBAAM,IAAI,6BAA6B;AACzF;AAAA,IACJ;AAEA,QAAI;AACA,UAAI,QAAQ,QAAQ,MAAM,KAAK,KAAK,GAAG,CAAC;AAAA,IAC5C,SAAS,GAAG;AACR,2BAAO,MAAM,oBAAoB,IAAI,IAAI,KAAM,EAAU,KAAK;AAC9D,aAAO,cAAc,GAAG,yBAAM,KAAK,WAAW,yBAAM,IAAI,mBAAmB;AAAA,IAC/E;AAAA,EACJ;AACJ;",
  "names": ["fs", "path"]
}
