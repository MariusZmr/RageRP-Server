{
  "version": 3,
  "sources": ["../../../../src/server/commands/CommandManager.ts"],
  "sourcesContent": ["import fs from \"fs\";\nimport path from \"path\";\nimport { Logger } from \"../utils/Logger\";\nimport { findCommand, getAllCommands } from \"./CommandRegistry\";\nimport { PlayerUtils } from \"../utils/PlayerUtils\";\n\nexport class CommandManager {\n    static async loadCommands() {\n        const commandsPath = __dirname;\n        const categories = [\"admin\", \"general\", \"roleplay\"];\n        \n        for (const cat of categories) {\n            const catPath = path.join(commandsPath, cat);\n            if (!fs.existsSync(catPath)) continue;\n\n            const files = fs.readdirSync(catPath).filter(f => f.endsWith(\".js\"));\n            for (const file of files) {\n                try {\n                    const fullPath = path.join(catPath, file);\n                    delete require.cache[require.resolve(fullPath)];\n                    require(fullPath);\n                } catch (e) {\n                    Logger.error(`[CMD] Eroare la incarcarea fi\u0219ierului ${file}:`, (e as any).message);\n                }\n            }\n        }\n\n        const totalCmds = getAllCommands();\n        Logger.info(`[CMD] Sistem activat. ${totalCmds.length} comenzi principale incarcate.`);\n    }\n\n    static handleCommand(player: PlayerMp, message: string) {\n        const args = message.split(\" \");\n        const cmdTrigger = args.shift()?.toLowerCase();\n        if (!cmdTrigger) return;\n\n        const cmd = findCommand(cmdTrigger);\n        if (!cmd) {\n            player.outputChatBox(\"!{#FF0000}Eroare: !{#FFFFFF}Comanda !{#FFFF00}/\" + cmdTrigger + \" !{#FFFFFF}nu exista. Foloseste !{#55FF55}/help.\");\n            return;\n        }\n\n        const user = PlayerUtils.getDb(player);\n        \n        // Logic for unauthenticated players\n        if (!user && cmd.name !== \"login\" && cmd.name !== \"register\") {\n            player.outputChatBox(\"!{#FF0000}Autentificare: !{#FFFFFF}Trebuie sa fii logat pentru a folosi comenzile.\");\n            return;\n        }\n\n        // Admin check\n        if (cmd.minAdmin && (!user || user.adminLevel < cmd.minAdmin)) {\n            player.outputChatBox(\"!{#FF0000}Permisiuni: !{#FFFFFF}Nu ai acces la aceasta comanda (Min Admin: \" + cmd.minAdmin + \").\");\n            return;\n        }\n\n        try {\n            cmd.execute(player, args, args.join(\" \"));\n        } catch (e) {\n            Logger.error(`Eroare fatala la comanda /${cmd.name}:`, (e as any).stack);\n            player.outputChatBox(\"!{#FF0000}Eroare: !{#FFFFFF}A intervenit o eroare interna la procesarea comenzii.\");\n        }\n    }\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAe;AACf,kBAAiB;AACjB,oBAAuB;AACvB,6BAA4C;AAC5C,yBAA4B;AAErB,MAAM,eAAe;AAAA,EACxB,aAAa,eAAe;AACxB,UAAM,eAAe;AACrB,UAAM,aAAa,CAAC,SAAS,WAAW,UAAU;AAElD,eAAW,OAAO,YAAY;AAC1B,YAAM,UAAU,YAAAA,QAAK,KAAK,cAAc,GAAG;AAC3C,UAAI,CAAC,UAAAC,QAAG,WAAW,OAAO,EAAG;AAE7B,YAAM,QAAQ,UAAAA,QAAG,YAAY,OAAO,EAAE,OAAO,OAAK,EAAE,SAAS,KAAK,CAAC;AACnE,iBAAW,QAAQ,OAAO;AACtB,YAAI;AACA,gBAAM,WAAW,YAAAD,QAAK,KAAK,SAAS,IAAI;AACxC,iBAAO,QAAQ,MAAM,QAAQ,QAAQ,QAAQ,CAAC;AAC9C,kBAAQ,QAAQ;AAAA,QACpB,SAAS,GAAG;AACR,+BAAO,MAAM,8CAAyC,IAAI,KAAM,EAAU,OAAO;AAAA,QACrF;AAAA,MACJ;AAAA,IACJ;AAEA,UAAM,gBAAY,uCAAe;AACjC,yBAAO,KAAK,yBAAyB,UAAU,MAAM,gCAAgC;AAAA,EACzF;AAAA,EAEA,OAAO,cAAc,QAAkB,SAAiB;AA/B5D;AAgCQ,UAAM,OAAO,QAAQ,MAAM,GAAG;AAC9B,UAAM,cAAa,UAAK,MAAM,MAAX,mBAAc;AACjC,QAAI,CAAC,WAAY;AAEjB,UAAM,UAAM,oCAAY,UAAU;AAClC,QAAI,CAAC,KAAK;AACN,aAAO,cAAc,oDAAoD,aAAa,kDAAkD;AACxI;AAAA,IACJ;AAEA,UAAM,OAAO,+BAAY,MAAM,MAAM;AAGrC,QAAI,CAAC,QAAQ,IAAI,SAAS,WAAW,IAAI,SAAS,YAAY;AAC1D,aAAO,cAAc,oFAAoF;AACzG;AAAA,IACJ;AAGA,QAAI,IAAI,aAAa,CAAC,QAAQ,KAAK,aAAa,IAAI,WAAW;AAC3D,aAAO,cAAc,gFAAgF,IAAI,WAAW,IAAI;AACxH;AAAA,IACJ;AAEA,QAAI;AACA,UAAI,QAAQ,QAAQ,MAAM,KAAK,KAAK,GAAG,CAAC;AAAA,IAC5C,SAAS,GAAG;AACR,2BAAO,MAAM,6BAA6B,IAAI,IAAI,KAAM,EAAU,KAAK;AACvE,aAAO,cAAc,mFAAmF;AAAA,IAC5G;AAAA,EACJ;AACJ;",
  "names": ["path", "fs"]
}
